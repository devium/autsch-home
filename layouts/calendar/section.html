{{ define "head" }}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.0/main.min.css" integrity="sha256-5veQuRbWaECuYxwap/IOE/DAwNxgm4ikX7nrgsqYp88=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
{{ end }}

{{ define "main" }}

<div class="modal" id="eventModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 id="modalTitle" class="modal-title">Event Title</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>
      <div id="modalBody" class="modal-body text-start">
      </div>
      <div id="modalFooter" class="modal-footer">
        <span id="modalFooterBadge" class="badge">&nbsp;</span>
        <span id="modalFooterText"></span>
      </div>
    </div>
  </div>
</div>

<div class="container bg-light rounded p-2">
  <div id="calendars-dropdown" class="dropdown text-start">
    <button class="btn btn-primary dropdown-toggle mt-1" type="button" data-bs-toggle="dropdown">
      Kalender
    </button>
    <ul class="dropdown-menu dropdown-menu-form">
      <table class="table align-middle">
        <thead>
          <tr>
            <th>
              <input class="form-check-input" type="checkbox" value="" id="checkbox-all" onclick="toggleAllCalendars();">
              <label class="form-check-label" for="checkbox-all">
                Alle / Keine
              </label>
            </th>
            <th>In Nextcloud Ã¶ffnen</th>
            <th>iCal-Link kopieren</th>
          </tr>
        </thead>

        <tbody>
          {{ range .Site.Data.calendars.items }}
          <tr>
            <td>
              <input class="form-check-input calendar-checkbox" type="checkbox" value="" id="{{ .id }}" onclick="refreshCalendars();" {{ if .checked }}checked{{ end }}>
              <span id="color-{{ .id }}" class="badge" style="background-color: {{ .color }}">&nbsp;</span>
              <label class="form-check-label user-select-none" for="{{ .id }}">
                {{ .name }}
              </label>
            </td>

            <td class="text-center">
              <a href="https://next.{{ $.Site.Params.baseDomain }}/apps/calendar/p/{{ .id }}" target="_blank" class="btn btn-xs"><span class="bi bi-box-arrow-up-right"></span></a>
            </td>

            <td class="text-center">
              <button class="btn btn-xs" role="button" onclick="copyICal({{ .id }});">
                <span id='copy-ical-icon-{{ .id }}' class="bi bi-clipboard-plus"></span>
              </button>
            </td>
          </tr>
          {{ end }}
        </tbody>
      </table>
    </ul>

    <a href="https://next.{{ $.Site.Params.baseDomain }}/apps/calendar" target="_blank" class="btn btn-primary mt-1">
      Eventvorschlag einreichen<span class="px-2 bi bi-box-arrow-up-right"></span>
    </a>
  </div>

  <div id='calendar' class="my-2">
  </div>
</div>

{{ end }}

{{ define "js" }}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.0/main.min.js" integrity="sha256-XCdgoNaBjzkUaEJiauEq+85q/xi/2D4NcB3ZHwAapoM=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ical.js/1.5.0/ical.min.js" integrity="sha512-0izBc1upGYnrS1u1MX7QR+sjFIxZWxLVdNI7cUoHHCutDr5ENjuQRZuS+v+3NFNGfwHSrPoHzBzED0rV651tGw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/@fullcalendar/icalendar@5.11.0/main.global.min.js" integrity="sha256-ntXRERg+VVCcjXguw81eZystarWC9Tqx3mlgtLNgYVk=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.0/locales-all.min.js" integrity="sha256-GcByKJnun2NoPMzoBsuCb4O2MKiqJZLlHTw3PJeqSkI=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/linkifyjs@3.0.5/dist/linkify.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/linkify-jquery@3.0.4/dist/linkify-jquery.min.js" integrity="sha256-uc66MYQfuzCk9FXabhgiV7PmXevUgraoxslXewknZ6U=" crossorigin="anonymous"></script>

{{ $calendarjs := resources.Get "/js/calendar.js" | resources.ExecuteAsTemplate "calendar.js" . | minify | fingerprint }}
<script src="{{ $calendarjs.RelPermalink }}" integrity="{{ $calendarjs.Data.integrity }}"></script>
{{ end }}
