{{ define "main" }}

<div class="container">
  <h1 class="text-white">{{ .Site.Title }}</h1>
</div>

<div class="container my-3">
  <h2 id="roomsHeading" class="text-white d-inline-block">
    Jitsi-Raumübersicht
  </h2>
  <div class="dropdown d-inline-block h2">
    <button type="button" class="btn dropdown-toggle text-white" data-bs-toggle="dropdown"></button>
    <ul class="dropdown-menu dropdown-menu-end">
      <li><a class="dropdown-item" href="#" onclick="requestNotificationPermission()">Aktiviere Raumbenachrichtungen</a></li>
    </ul>
  </div>
  <div id="rooms" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 justify-content-center text-start">
    <div class="col">
      <div class="text-dark d-block card">
        <div class="card-header text-center">
          <h5 class="card-title">Neuer Raum</h5>
        </div>
        <div class="card-body">
          <div class="input-group mb-3">
            <input id="roomname" class="form-control" type="text" placeholder="Raum">
            <button type="button" class="btn btn-outline-dark" onclick="window.open('https://{{ $.Site.Params.subdomains.jitsiKeycloak }}.{{ $.Site.Params.baseDomain }}/' + $('#roomname').val(), '_blank')">
              Eröffnen
            </button>
          </div>
          <p class="card-text text-start">Räume, die mit _ beginnen, werden nicht gelistet.</p>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container my-3">
  <h2 class="text-white">Apps</h2>
  <div class="row row-cols-2 row-cols-md-3 g-4 justify-content-center">
    {{ range .Site.Data.links.items }}
    <div class="col">
      {{ $url := printf "https://%s%s/%s" .subDomain $.Site.Params.baseDomain (default "" .uri) }}
      <a href="{{ $url }}" target="_blank" class="text-decoration-none text-dark d-block card card-hover cursorPointer h-100">
        <div class="card-body">
          {{ $img := resources.Get (path.Join "/img/" .icon) }}
          <img src="{{ $img.RelPermalink }}" class="card-icon mx-auto mb-2 {{ if .bg }} bg-primary bg-gradient {{ end }} rounded" width="56px">
          <h5 class="card-title">
            {{ .title | safeHTML }}
          </h5>
        </div>
      </a>
    </div>
    {{ end }}
  </div>
</div>

{{ end }}

{{ define "js" }}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"crossorigin="anonymous"></script>
{{ $rooms := resources.Get "/js/rooms.js" | resources.ExecuteAsTemplate "rooms.js" . | minify | fingerprint }}
<script src="{{ $rooms.RelPermalink }}"integrity="{{ $rooms.Data.integrity }}"></script>
{{ end }}
